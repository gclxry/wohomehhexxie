//////////////////////////////////////////////////////////////////////////
// 属性

#pragma once
#include "IPropertyBase.h"
#include "CDrawingBoard.h"
#include "IPropertyImageBase.h"

class IPropertyImage : public IPropertyBase
{
public:
	IPropertyImage();
	virtual ~IPropertyImage();

	virtual void SetActivePropetry(bool bIsActive);
	virtual bool GetActivePropetry();

	// 是否为合法数据
	virtual bool IsRightData();
	// 从XML节点读取属性值，并放入属性队列
	virtual bool ReadPropertyFromXmlNode(XmlNode* pXmlNode);
	// 写入xml
	virtual bool AppendToXmlNode(CUiXmlWrite &XmlStrObj, CUiXmlWriteNode* pParentXmlNode);

//////////////////////////////////////////////////////////////////////////
	IPropertyImageBase* GetImageBaseProp();
	void SetImageBaseProp(IPropertyImageBase* pNewImgBase);
	const char * GetImageBaseName();
	SIZE GetImageSize();
	void SetNeedRedraw();
	// 初始化Image，将Image加载到内存，程序默认是没有加载图片数据的
	void InitImage();
	// 轻量级动画定时器绘制动画
	bool OnDrawAnimation();

	// 绘制图片，如果alpha不是255，则根据这个alpha值来绘制
	bool DrawImage(CDrawingBoard &DstDc, RECT DstRct, int nAlpha = 255);
	bool DrawImage(HDC hDc, RECT DstRct, int nAlpha = 255);
};
